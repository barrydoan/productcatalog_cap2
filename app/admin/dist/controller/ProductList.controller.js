sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/ui/table/RowAction","sap/ui/table/RowActionItem","sap/ui/table/RowSettings","sap/m/MessageToast","./BaseController","sap/ui/model/odata/v4/ODataModel"],function(e,t,a,o,n,i,s,r){"use strict";return s.extend("admin.controller.ProductList",{onInit:function(){this._oStorage=jQuery.sap.storage(jQuery.sap.storage.Type.local);var e=this.handleActionPress.bind(this);this.modes=[{key:"Navigation",text:"Navigation",handler:function(){var t=new a({items:[new o({type:"Navigation",press:e,visible:"{Available}"})]});return[1,t]}},{key:"NavigationAdd",text:"Navigation & Add",handler:function(){var t=new a({items:[new o({type:"Navigation",press:e,visible:"{Available}"}),new o({icon:"sap-icon://cart-4",text:"Add",press:e})]});return[2,t]}},{key:"NavigationDelete",text:"Navigation & Delete",handler:function(){var t=new a({items:[new o({type:"Navigation",press:e,visible:"{Available}"}),new o({type:"Delete",press:e})]});return[2,t]}},{key:"NavigationCustom",text:"Navigation & Custom",handler:function(){var t=new a({items:[new o({type:"Navigation",press:e,visible:"{Available}"}),new o({icon:"sap-icon://edit",text:"Edit",press:e})]});return[2,t]}},{key:"Multi",text:"Multiple Actions",handler:function(){var t=new a({items:[new o({icon:"sap-icon://attachment",text:"Attachment",press:e}),new o({icon:"sap-icon://search",text:"Search",press:e}),new o({icon:"sap-icon://edit",text:"Edit",press:e}),new o({icon:"sap-icon://line-chart",text:"Analyze",press:e})]});return[2,t]}},{key:"None",text:"No Actions",handler:function(){return[0,null]}}];this.getView().setModel(new t({items:this.modes}),"modes");this.switchState("Navigation")},onNavIndicatorsToggle:function(e){var t=this.byId("table");var a=e.getSource();if(a.getPressed()){t.setRowSettingsTemplate(new n({navigated:"{NavigatedState}"}))}else{t.setRowSettingsTemplate(null)}},onBehaviourModeChange:function(e){this.switchState(e.getParameter("selectedItem").getKey())},switchState:function(e){var t=this.byId("table");var a=0;var o=t.getRowActionTemplate();if(o){o.destroy();o=null}for(var n=0;n<this.modes.length;n++){if(e==this.modes[n].key){var i=this.modes[n].handler();a=i[0];o=i[1];break}}t.setRowActionTemplate(o);t.setRowActionCount(a)},handleActionPress:function(e){var t=e.getParameter("row");var a=e.getParameter("item");var o=e.getSource();var n=o.getBindingContext();var i=n.getProperty("ID");var s=n.getProperty("acqCost");console.log("acqCost",s);console.log("productId",i);console.log("oRow",t);console.log("oItem",a);if(a.getType()==="Navigation"){this.getRouter().navTo("RouteProductDetail",{productId:i})}else if(a.getText()==="Add"){console.log("Add product to cart ",i);var l=this._oStorage.get("baseModel");var c=JSON.parse(l);var d={parent_ID:c.ID,product_ID:parseInt(i),amount:1,netAmount:s};console.log("data",d);if(c.ID==""){alert("Please select cart")}else{var u=new r({groupId:"$auto",synchronizationMode:"None",serviceUrl:this.getBaseUrl()+"/admin/"});var g=u.bindList("/CartItems",undefined,undefined,undefined,{$$updateGroupId:"AddToCart"});var n=g.create(d);n.created();u.submitBatch("AddToCart").then(function(){console.log("success")},function(){console.log("error")})}}}})});